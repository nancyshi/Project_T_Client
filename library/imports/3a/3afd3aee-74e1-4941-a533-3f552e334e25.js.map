{"version":3,"sources":["../../../../../../assets/scripts/towerDefens/towers/assets/scripts/towerDefens/towers/buildTowerUIMgr.js"],"names":["cc","Class","extends","Component","properties","buttonsConfig","btnPrefab","Prefab","onLoad","start","enabledTowerIds","find","getComponent","index","towerId","btnIndex","parseInt","btnName","toString","btn","node","getChildByName","Button","clickEventHandler","EventHandler","target","component","handler","customEventData","clickEvents","push","buildTower","event","towerConfig","require","oneTowerConfig","towerLevel","towerObj","resId","prefab","reses","prefabName","tower","instantiate","x","parent","y","towerMgr","hurt","hurtType","hurtDelta","attackRange","hurtRange","parentNode","removeUI","tween","window","delay","call","removeFromParent","addChild"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,uBAAe,IAhBP;AAiBRC,mBAAUN,GAAGO;AAjBL,KAHP;;AAuBL;;AAEAC,UAzBK,oBAyBK,CAET,CA3BI;AA6BLC,SA7BK,mBA6BI;AACL,YAAIC,kBAAkBV,GAAGW,IAAH,CAAQ,gBAAR,EAA0BC,YAA1B,CAAuC,QAAvC,EAAiDF,eAAvE;AACA,aAAI,IAAIG,KAAR,IAAiBH,eAAjB,EAAkC;AAC9B,gBAAII,UAAUJ,gBAAgBG,KAAhB,CAAd;AACA,gBAAIE,WAAWC,SAASH,KAAT,IAAkB,CAAjC;AACA,gBAAII,UAAU,UAAUF,SAASG,QAAT,EAAxB;;AAEA,gBAAIC,MAAM,KAAKC,IAAL,CAAUC,cAAV,CAAyBJ,OAAzB,EAAkCL,YAAlC,CAA+CZ,GAAGsB,MAAlD,CAAV;;AAEA,gBAAIC,oBAAoB,IAAIvB,GAAGG,SAAH,CAAaqB,YAAjB,EAAxB;AACAD,8BAAkBE,MAAlB,GAA2B,KAAKL,IAAhC;AACAG,8BAAkBG,SAAlB,GAA8B,iBAA9B;AACAH,8BAAkBI,OAAlB,GAA4B,YAA5B;AACAJ,8BAAkBK,eAAlB,GAAoCd,OAApC;;AAEAK,gBAAIU,WAAJ,CAAgBC,IAAhB,CAAqBP,iBAArB;AACH;AACJ,KA9CI;AAgDLQ,cAhDK,sBAgDMC,KAhDN,EAgDYlB,OAhDZ,EAgDqB;AACtB,YAAImB,cAAcC,QAAQ,aAAR,CAAlB;AACA,YAAIC,iBAAiBF,YAAYnB,QAAQI,QAAR,EAAZ,CAArB;AACA,YAAIkB,aAAa,CAAjB,CAHsB,CAGH;AACnB,YAAIC,WAAWF,eAAeC,WAAWlB,QAAX,EAAf,CAAf;AACA,YAAIoB,QAAQD,SAASC,KAArB;AACA,YAAIC,SAASvC,GAAGW,IAAH,CAAQ,gBAAR,EAA0BC,YAA1B,CAAuC,QAAvC,EAAiD4B,KAAjD,CAAuDF,MAAMpB,QAAN,EAAvD,EAAyEuB,UAAtF;;AAEA,YAAIC,QAAQ1C,GAAG2C,WAAH,CAAeJ,MAAf,CAAZ;AACAG,cAAME,CAAN,GAAU,KAAKxB,IAAL,CAAUyB,MAAV,CAAiBD,CAA3B;AACAF,cAAMI,CAAN,GAAU,KAAK1B,IAAL,CAAUyB,MAAV,CAAiBC,CAA3B;;AAEA,YAAIC,WAAWL,MAAM9B,YAAN,CAAmB,UAAnB,CAAf;AACAmC,iBAASC,IAAT,GAAgBX,SAASW,IAAzB;AACAD,iBAASE,QAAT,GAAoBZ,SAASY,QAA7B;AACAF,iBAASG,SAAT,GAAqBb,SAASa,SAA9B;AACAH,iBAASI,WAAT,GAAuBd,SAASc,WAAhC;AACAJ,iBAASK,SAAT,GAAqBf,SAASe,SAA9B;;AAEA,YAAIC,aAAa,KAAKjC,IAAL,CAAUyB,MAA3B;AACA,aAAKzB,IAAL,CAAUyB,MAAV,CAAiBjC,YAAjB,CAA8B,cAA9B,EAA8C0C,QAA9C;;AAEAtD,WAAGuD,KAAH,CAASC,MAAT,EACKC,KADL,CACW,GADX,EAEKC,IAFL,CAEU,YAAU;AACZL,uBAAWM,gBAAX;AACA3D,eAAGW,IAAH,CAAQ,QAAR,EAAkBiD,QAAlB,CAA2BlB,KAA3B;AACH,SALL,EAMKjC,KANL;AAOH;;AAED;;AA/EK,CAAT","file":"buildTowerUIMgr.js","sourceRoot":"../../../../../../assets/scripts/towerDefens/towers","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        buttonsConfig: null,\n        btnPrefab:cc.Prefab\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n\n    },\n\n    start () {\n        var enabledTowerIds = cc.find(\"Canvas/resNode\").getComponent(\"resMgr\").enabledTowerIds\n        for(var index in enabledTowerIds) {\n            var towerId = enabledTowerIds[index]\n            var btnIndex = parseInt(index) + 1\n            var btnName = \"btn_0\" + btnIndex.toString()\n\n            var btn = this.node.getChildByName(btnName).getComponent(cc.Button)\n\n            var clickEventHandler = new cc.Component.EventHandler()\n            clickEventHandler.target = this.node\n            clickEventHandler.component = \"buildTowerUIMgr\"\n            clickEventHandler.handler = \"buildTower\"\n            clickEventHandler.customEventData = towerId\n\n            btn.clickEvents.push(clickEventHandler)\n        }\n    },\n\n    buildTower(event,towerId) {\n        var towerConfig = require(\"towerConfig\")\n        var oneTowerConfig = towerConfig[towerId.toString()]\n        var towerLevel = 1 //for now use a fixed level\n        var towerObj = oneTowerConfig[towerLevel.toString()]\n        var resId = towerObj.resId\n        var prefab = cc.find(\"Canvas/resNode\").getComponent(\"resMgr\").reses[resId.toString()].prefabName\n        \n        var tower = cc.instantiate(prefab)\n        tower.x = this.node.parent.x\n        tower.y = this.node.parent.y\n\n        var towerMgr = tower.getComponent(\"towerMgr\")\n        towerMgr.hurt = towerObj.hurt\n        towerMgr.hurtType = towerObj.hurtType\n        towerMgr.hurtDelta = towerObj.hurtDelta\n        towerMgr.attackRange = towerObj.attackRange\n        towerMgr.hurtRange = towerObj.hurtRange\n\n        var parentNode = this.node.parent\n        this.node.parent.getComponent(\"towerAreaMgr\").removeUI()\n        \n        cc.tween(window)\n            .delay(0.2)\n            .call(function(){\n                parentNode.removeFromParent()\n                cc.find(\"Canvas\").addChild(tower)\n            })\n            .start()\n    }\n\n    // update (dt) {},\n});\n"]}